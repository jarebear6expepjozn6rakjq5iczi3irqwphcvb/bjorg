#!/usr/bin/env bash
HISTSIZE=0
set +o history

echo "SETUP UP HOSTS NOW OK THANKS"

echo "Getting default ethernet interface..."
interface=$(ip -br l | awk '$1 !~ "lo|vir|wl" { print $1}')

# Extract public v4 and v6 IP
# TODO a better job extracting
ipv6=$(echo "$(/sbin/ip -o -6 route show to default)" | awk '{print $3}')
ipv4=$(echo "$(/sbin/ip -o -4 route show to default)" | awk '{print $9}')

# Update hostname appropriately 
echo "$HOSTNAME" > /etc/hostname

# Add public entries to /etc/hosts
cat <<EOT >> /etc/hosts

# public entries
# TODO add support for subdomains some day probably
$ipv6 $HOSTNAME.$FQDN $HOSTNAME
$ipv4 $HOSTNAME.$FQDN $HOSTNAME
EOT
